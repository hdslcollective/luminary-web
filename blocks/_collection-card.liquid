{% liquid
  assign collection = block.settings.collection
  assign block_settings = block.settings
  assign onboarding = false

  if collection == blank
    assign onboarding = true
  endif
%}

{% capture card_image %}
  {% if collection.featured_image or onboarding %}
    <div class="collection-card__image">
      {% if collection.featured_image %}
        {{
          collection.featured_image
          | image_url: width: 1200
          | image_tag:
            class: 'image-block__image',
            alt: collection.title,
            loading: 'lazy'
        }}
      {% else %}
        {{ 'collection-1' | placeholder_svg_tag: 'placeholder-svg' }}
      {% endif %}
    </div>
  {% endif %}
{% endcapture %}

{% capture children %}
  {% content_for 'blocks' %}
{% endcapture %}

{% render 'collection-card',
  card_image: card_image,
  children: children,
  block: block,
  collection: collection,
  section: section
%}

{% schema %}
{
  "name": "t:names.collection_card",
  "settings": [
    {
      "type": "collection",
      "id": "collection",
      "label": "t:settings.collection"
    },
    {
      "type": "select",
      "id": "placement",
      "label": "t:settings.content_placement",
      "options": [
        {
          "value": "below_image",
          "label": "t:options.below_image"
        },
        {
          "value": "on_image",
          "label": "t:options.on_image"
        }
      ],
      "default": "below_image"
    },
    {
      "type": "select",
      "id": "horizontal_alignment",
      "label": "t:settings.horizontal_alignment",
      "options": [
        {
          "value": "flex-start",
          "label": "t:options.left"
        },
        {
          "value": "center",
          "label": "t:options.center"
        },
        {
          "value": "flex-end",
          "label": "t:options.right"
        }
      ],
      "default": "center"
    },
    {
      "type": "select",
      "id": "vertical_alignment",
      "label": "t:settings.vertical_alignment",
      "options": [
        {
          "value": "flex-start",
          "label": "t:options.top"
        },
        {
          "value": "center",
          "label": "t:options.center"
        },
        {
          "value": "flex-end",
          "label": "t:options.bottom"
        }
      ],
      "default": "center"
    },
    {
      "type": "range",
      "id": "collection_card_gap",
      "label": "t:settings.gap",
      "min": 0,
      "max": 50,
      "step": 1,
      "unit": "px",
      "default": 8
    },
    {
      "type": "checkbox",
      "id": "inherit_color_scheme",
      "label": "t:settings.inherit_color_scheme",
      "default": true
    },
    {
      "type": "color_scheme",
      "id": "color_scheme",
      "label": "t:settings.color_scheme",
      "default": "scheme-1",
      "visible_if": "{{ block.settings.inherit_color_scheme == false }}"
    },
    {
      "type": "color",
      "id": "overlay_color",
      "label": "t:settings.overlay_color",
      "alpha": true,
      "default": "#00000026",
      "visible_if": "{{ block.settings.placement == 'on_image' }}"
    }
  ],
  "blocks": [
    {
      "type": "text"
    }
  ]
}
{% endschema %}
