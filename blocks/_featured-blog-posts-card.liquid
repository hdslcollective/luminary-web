{% liquid
  assign article = block.settings.article
  assign block_settings = block.settings
  assign onboarding = false

  if article == blank
    assign onboarding = true
  endif
%}

<article class="blog-post-card" {{ block.shopify_attributes }}>
  <a href="{{ article.url | default: '#' }}" class="blog-post-card__link">
    {% if block_settings.show_image %}
      <div class="blog-post-card__image-wrapper">
        {% if article.image %}
          {{
            article.image
            | image_url: width: 800
            | image_tag:
              class: 'blog-post-card__image',
              alt: article.title,
              loading: 'lazy'
          }}
        {% else %}
          {{ 'blog-1' | placeholder_svg_tag: 'placeholder-svg' }}
        {% endif %}
      </div>
    {% endif %}

    <div class="blog-post-card__content">
      {% if block_settings.show_date and article.published_at %}
        <time class="blog-post-card__date" datetime="{{ article.published_at | date: '%Y-%m-%d' }}">
          {{ article.published_at | date: format: 'month_day_year' }}
        </time>
      {% endif %}

      <h3 class="blog-post-card__title">
        {{ article.title | default: 'Article Title' }}
      </h3>

      {% if block_settings.show_excerpt and article.excerpt %}
        <div class="blog-post-card__excerpt">
          {{ article.excerpt | strip_html | truncate: 150 }}
        </div>
      {% endif %}

      {% if block_settings.show_author and article.author %}
        <p class="blog-post-card__author">{{ 'blogs.article.by_author' | t: author: article.author }}</p>
      {% endif %}
    </div>
  </a>
</article>

{% stylesheet %}
  .blog-post-card {
    display: flex;
    flex-direction: column;
  }

  .blog-post-card__link {
    text-decoration: none;
    color: currentColor;
    display: flex;
    flex-direction: column;
    height: 100%;
  }

  .blog-post-card__image-wrapper {
    width: 100%;
    aspect-ratio: 16 / 9;
    overflow: hidden;
    margin-bottom: 1rem;
  }

  .blog-post-card__image {
    width: 100%;
    height: 100%;
    object-fit: cover;
  }

  .blog-post-card__content {
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
  }

  .blog-post-card__date {
    font-size: 0.875rem;
    opacity: 0.7;
  }

  .blog-post-card__title {
    margin: 0;
  }

  .blog-post-card__excerpt {
    font-size: 0.875rem;
    line-height: 1.5;
  }

  .blog-post-card__author {
    font-size: 0.875rem;
    margin: 0;
    opacity: 0.7;
  }

  .blog-post-card:hover .blog-post-card__title {
    text-decoration: underline;
  }
{% endstylesheet %}

{% schema %}
{
  "name": "t:names.blog_post",
  "settings": [
    {
      "type": "article",
      "id": "article",
      "label": "t:settings.article"
    },
    {
      "type": "checkbox",
      "id": "show_image",
      "label": "t:settings.show_image",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "show_date",
      "label": "t:settings.show_date",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "show_author",
      "label": "t:settings.show_author",
      "default": false
    },
    {
      "type": "checkbox",
      "id": "show_excerpt",
      "label": "t:settings.show_excerpt",
      "default": true
    }
  ]
}
{% endschema %}
